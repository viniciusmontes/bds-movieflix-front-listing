{"ast":null,"code":"import { jwtDecode } from \"jwt-decode\";\nimport { getAuthData } from \"./storage\";\nexport const getTokenData = () => {\n  try {\n    return jwtDecode(getAuthData().access_token);\n  } catch (error) {\n    return undefined;\n  }\n};\nexport const isAuthenticated = () => {\n  const tokenData = getTokenData();\n  return tokenData && tokenData.exp * 100 > Date.now() ? true : false;\n};\nexport const hasAnyRoles = roles => {\n  if (roles.length === 0) {\n    return true;\n  }\n  const tokenData = getTokenData();\n  if (tokenData !== undefined) {\n    return roles.some(role => tokenData.authorities.includes(role));\n  }\n  return false;\n};","map":{"version":3,"names":["jwtDecode","getAuthData","getTokenData","access_token","error","undefined","isAuthenticated","tokenData","exp","Date","now","hasAnyRoles","roles","length","some","role","authorities","includes"],"sources":["/Users/viniciusvini/Documents/workspace-vscode/bds-movieflix/frontweb/src/util/auth.ts"],"sourcesContent":["import { jwtDecode } from \"jwt-decode\";\nimport { getAuthData } from \"./storage\";\n\nexport type Role = \"VISITOR\" | \"MEMBER\";\n\nexport type TokenData = {\n  exp: number;\n  user_name: string;\n  authorities: Role[];\n};\n\nexport const getTokenData = (): TokenData | undefined => {\n  try {\n    return jwtDecode(getAuthData().access_token) as TokenData;\n  } catch (error) {\n    return undefined;\n  }\n};\n\nexport const isAuthenticated = (): boolean => {\n  const tokenData = getTokenData();\n  return tokenData && tokenData.exp * 100 > Date.now() ? true : false;\n};\n\nexport const hasAnyRoles = (roles: Role[]): boolean => {\n  if (roles.length === 0) {\n    return true;\n  }\n  const tokenData = getTokenData();\n\n  if (tokenData !== undefined) {\n    return roles.some((role) => tokenData.authorities.includes(role));\n  }\n  return false\n};\n"],"mappings":"AAAA,SAASA,SAAS,QAAQ,YAAY;AACtC,SAASC,WAAW,QAAQ,WAAW;AAUvC,OAAO,MAAMC,YAAY,GAAGA,CAAA,KAA6B;EACvD,IAAI;IACF,OAAOF,SAAS,CAACC,WAAW,CAAC,CAAC,CAACE,YAAY,CAAC;EAC9C,CAAC,CAAC,OAAOC,KAAK,EAAE;IACd,OAAOC,SAAS;EAClB;AACF,CAAC;AAED,OAAO,MAAMC,eAAe,GAAGA,CAAA,KAAe;EAC5C,MAAMC,SAAS,GAAGL,YAAY,CAAC,CAAC;EAChC,OAAOK,SAAS,IAAIA,SAAS,CAACC,GAAG,GAAG,GAAG,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,IAAI,GAAG,KAAK;AACrE,CAAC;AAED,OAAO,MAAMC,WAAW,GAAIC,KAAa,IAAc;EACrD,IAAIA,KAAK,CAACC,MAAM,KAAK,CAAC,EAAE;IACtB,OAAO,IAAI;EACb;EACA,MAAMN,SAAS,GAAGL,YAAY,CAAC,CAAC;EAEhC,IAAIK,SAAS,KAAKF,SAAS,EAAE;IAC3B,OAAOO,KAAK,CAACE,IAAI,CAAEC,IAAI,IAAKR,SAAS,CAACS,WAAW,CAACC,QAAQ,CAACF,IAAI,CAAC,CAAC;EACnE;EACA,OAAO,KAAK;AACd,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}